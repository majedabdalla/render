# MultiChatBot - Telegram Bot

بوت تلغرام متعدد الوظائف مصمم لتسهيل التواصل والبحث عن شركاء مع دعم متعدد اللغات وميزات متقدمة.

## الميزات الرئيسية

*   **دعم متعدد اللغات:** العربية، الإنجليزية، الهندية، الإندونيسية.
*   **ملف تعريف المستخدم:** جمع اللغة المفضلة، الجنس، والبلد (عبر اختيار المنطقة ثم البلد).
*   **إعادة توجيه المحتوى:** إعادة إرسال رسائل المستخدمين (نصوص، صور، فيديوهات، ملفات) إلى مجموعة تلغرام محددة.
*   **بحث متقدم عن شريك (ميزة مدفوعة):**
    *   البحث بناءً على اللغة، الجنس، والبلد المطلوب للشريك.
    *   آلية دفع عبر Payeer و Bitcoin.
    *   نظام تحقق شبه يدوي من الدفع لتفعيل الميزة.
*   **صلاحيات المشرف:**
    *   تفعيل/رفض طلبات الميزة المدفوعة.
    *   حظر/فك حظر المستخدمين.
    *   عرض قائمة بجميع المستخدمين وبياناتهم.
    *   مراقبة سجلات المحادثات (عبر المجموعة المستهدفة).

## الإعداد على Replit

1.  **إنشاء حساب على Replit:** إذا لم يكن لديك حساب، قم بإنشاء واحد على [replit.com](https://replit.com).
2.  **إنشاء Repl جديد:**
    *   انقر على "Create Repl" أو "+".
    *   اختر "Import from GitHub".
    *   أدخل رابط مستودع GitHub الخاص بهذا المشروع (إذا كان متاحًا)، أو قم بإنشاء Repl فارغ من نوع "Python" ثم قم برفع ملفات المشروع يدويًا.
3.  **رفع ملفات المشروع:**
    *   قم بتنزيل جميع ملفات المشروع (الكود، مجلد `data`، مجلد `locales`، `requirements.txt`، `config.py`، `main.py`، `README.md`، إلخ).
    *   في واجهة Replit، استخدم خيار "Upload files" و "Upload folder" لرفع جميع الملفات والمجلدات إلى الـ Repl الخاص بك. تأكد من الحفاظ على نفس هيكل المجلدات.
4.  **إعداد متغيرات البيئة (Secrets):**
    *   في الشريط الجانبي الأيسر لـ Replit، انقر على أيقونة القفل "Secrets".
    *   أضف المتغيرات التالية مع قيمها المناسبة:
        *   `BOT_TOKEN`: توكن بوت تلغرام الخاص بك (احصل عليه من BotFather).
        *   `ADMIN_ID`: معرف تلغرام الخاص بحساب المشرف (رقم).
        *   `TARGET_GROUP_ID`: معرف مجموعة تلغرام التي سيتم إعادة توجيه الرسائل إليها (رقم، يجب أن يبدأ بـ `-100` للمجموعات الخارقة).
        *   `PAYEER_ACCOUNT`: حساب Payeer الخاص بك لاستقبال المدفوعات (مثال: `P1060900640`).
        *   `BITCOIN_ADDRESS`: عنوان Bitcoin الخاص بك لاستقبال المدفوعات.
    *   **ملاحظة:** القيم الموجودة في ملف `config.py` هي قيم افتراضية. سيقوم الكود بمحاولة قراءة هذه القيم من متغيرات البيئة (Secrets) أولاً. إذا لم يجدها، سيستخدم القيم الافتراضية من `config.py`. من الأفضل دائمًا استخدام Secrets للمعلومات الحساسة.
5.  **تثبيت الاعتماديات:**
    *   افتح نافذة الـ "Shell" في Replit.
    *   قم بتشغيل الأمر التالي لتثبيت المكتبات المطلوبة:
        ```bash
        pip install -r requirements.txt
        ```
6.  **تشغيل البوت:**
    *   في نافذة الـ "Shell" أو مباشرة بالضغط على زر "Run" الأخضر في الأعلى.
    *   سيقوم الأمر الافتراضي (عادةً `python main.py`) بتشغيل البوت.
    *   سترى رسالة في الـ Console مثل "Starting bot..." و "Bot application built. Starting Flask server for keep-alive...".

## ربط البوت بـ Uptimerobot (لضمان استمرارية العمل)

Replit يقوم بإيقاف الـ Repls غير النشطة. للحفاظ على البوت يعمل 24/7، يمكنك استخدام خدمة مثل Uptimerobot لعمل Ping دوري على الويب سيرفر الصغير المدمج في البوت.

1.  **الحصول على رابط الـ Webview:**
    *   عند تشغيل البوت في Replit، ستظهر نافذة "Webview" تعرض عادةً عنوان URL مثل `https://<repl-name>.<username>.repl.co`.
    *   هذا الرابط يعرض رسالة "MultiChatBot is alive!". انسخ هذا الرابط.
2.  **إنشاء حساب على Uptimerobot:**
    *   اذهب إلى [uptimerobot.com](https://uptimerobot.com) وقم بإنشاء حساب مجاني.
3.  **إضافة Monitor جديد:**
    *   في لوحة تحكم Uptimerobot، انقر على "Add New Monitor".
    *   **Monitor Type:** اختر `HTTP(s)`.
    *   **Friendly Name:** أدخل اسمًا للبوت (مثال: MultiChatBot).
    *   **URL (or IP):** الصق رابط الـ Webview الذي نسخته من Replit.
    *   **Monitoring Interval:** اختر فترة مناسبة (مثلاً، كل 5 أو 10 دقائق). الخطة المجانية تسمح بفترات قصيرة.
    *   اترك باقي الإعدادات على الوضع الافتراضي أو عدلها حسب حاجتك.
    *   انقر على "Create Monitor".

بهذه الطريقة، سيقوم Uptimerobot بزيارة رابط الـ Webview الخاص بالبوت بشكل دوري، مما يبقيه نشطًا على Replit.

## آلية الدفع والتحقق (للميزة المدفوعة)

1.  **طلب الميزة:** عندما يحاول المستخدم استخدام ميزة البحث المتقدم عن شريك (`/search`) ولم يكن لديه اشتراك مفعل، سيقوم البوت بعرض معلومات الدفع (حساب Payeer وعنوان Bitcoin).
2.  **الدفع:** يقوم المستخدم بالدفع إلى أحد الحسابات المذكورة.
3.  **إرسال إثبات الدفع:**
    *   بعد الدفع، يضغط المستخدم على زر "لقد قمت بالدفع - تحقق الآن" (أو ما يعادله بلغته).
    *   يطلب منه البوت إرسال إثبات الدفع (معرف المعاملة، لقطة شاشة، إلخ).
    *   يقوم المستخدم بإرسال الإثبات كرسالة عادية للبوت.
4.  **إشعار المشرف:**
    *   يقوم البوت بإعادة توجيه رسالة إثبات الدفع إلى حساب المشرف (`ADMIN_ID`).
    *   تصل للمشرف رسالة تحتوي على تفاصيل المستخدم وزرين: "Approve" و "Reject".
5.  **تحقق المشرف وتفعيل الميزة:**
    *   يقوم المشرف بالتحقق من صحة الدفع يدويًا.
    *   إذا كان الدفع صحيحًا، يضغط المشرف على زر "Approve". يقوم البوت بتفعيل الميزة للمستخدم وتحديث حالته في ملف `user_data.json` وإرسال رسالة تأكيد للمستخدم.
    *   إذا كان الدفع غير صحيح أو مرفوض، يضغط المشرف على زر "Reject". يقوم البوت بإرسال رسالة للمستخدم تفيد برفض التحقق.

## صلاحيات المشرف (Admin Commands)

يمكن للمشرف (صاحب `ADMIN_ID`) استخدام الأوامر التالية مباشرة في محادثته مع البوت:

*   `/block <user_id>`: لحظر مستخدم معين من استخدام البوت وإعادة توجيه رسائله. مثال: `/block 123456789`.
*   `/unblock <user_id>`: لفك حظر مستخدم معين. مثال: `/unblock 123456789`.
*   `/users`: لعرض قائمة بجميع المستخدمين المسجلين في البوت مع تفاصيلهم (الاسم، المعرف، اللغة، الجنس، البلد، حالة الاشتراك المدفوع، حالة الحظر).

## ملفات البيانات

يستخدم البوت ملفات JSON لتخزين البيانات:

*   `data/user_data.json`: يخزن معلومات ملفات تعريف المستخدمين، حالتهم (عادي/مميز/محظور).
*   `data/pending_payments.json`: يخزن طلبات التحقق من الدفع المعلقة.
*   `data/regions_countries.json`: يخزن قائمة المناطق والبلدان التابعة لكل منطقة.
*   `locales/*.json`: ملفات الترجمة لكل لغة مدعومة (en, ar, hi, id).

تأكد من أن مجلد `data` ومجلد `locales` موجودان في جذر المشروع وأن البوت لديه صلاحيات القراءة والكتابة عليهما.

## ملاحظات هامة

*   **أمان التوكن:** حافظ على `BOT_TOKEN` الخاص بك سريًا ولا تشاركه أبدًا. استخدم متغيرات البيئة (Secrets) في Replit.
*   **معرف المجموعة:** تأكد من أن `TARGET_GROUP_ID` صحيح وأن البوت عضو في المجموعة ولديه صلاحيات لإرسال الرسائل فيها.
*   **النسخ الاحتياطي:** قم بعمل نسخ احتياطية من ملفات البيانات (خاصة `user_data.json`) بشكل دوري، حيث أن Replit قد لا يوفر حلول نسخ احتياطي متقدمة للحسابات المجانية.

نتمنى لك التوفيق في استخدام MultiChatBot!

